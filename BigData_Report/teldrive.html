<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Hướng dẫn TeleDrive</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
    <style>
        body { background: #f4f6f8; }
        .header-bar { background: #009688; color: white; padding: 15px 0; margin-bottom: 30px; }
        .step-card { background: white; border-radius: 8px; padding: 25px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .step-number { background: #009688; color: white; width: 30px; height: 30px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; margin-right: 10px; font-weight: bold; }
        h2 { font-size: 1.3rem; font-weight: 700; color: #333; display: flex; align-items: center; }
        img { max-width: 100%; border: 1px solid #dee2e6; border-radius: 4px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="header-bar">
        <div class="container d-flex justify-content-between align-items-center">
            <h4 class="m-0">CÀI ĐẶT TELEDRIVE</h4>
            <a href="index.html" class="btn btn-outline-light btn-sm">Quay lại Trang chủ</a>
        </div>
    </div>

    <div class="container pb-5">
        
        <div class="step-card">
            <h2><span class="step-number">1</span> Chuẩn bị Môi trường</h2>
            <p>Tạo thư mục dự án và cấu trúc file như sau:</p>
            <pre><code class="language-bash">/PTDLL
├── teldrive_data/      (Tự động tạo)
├── pg_data/            (Tự động tạo)
└── docker-compose.yml  (File cấu hình chính)</code></pre>
        </div>

        <div class="step-card">
            <h2><span class="step-number">2</span> Cấu hình Docker Compose</h2>
            <p>Tạo file <code>docker-compose.yml</code>. Lưu ý sử dụng image <code>groonga/pgroonga</code> cho Database để hỗ trợ tìm kiếm file tốt nhất.</p>
            <pre><code class="language-yaml">version: '3.9'

services:
  db:
    image: groonga/pgroonga:latest-alpine-16
    container_name: teldrive-db
    restart: always
    environment:
      POSTGRES_USER: teldrive
      POSTGRES_PASSWORD: teldrive_password
      POSTGRES_DB: teldrive
    volumes:
      - ./pg_data:/var/lib/postgresql/data
    networks:
      - teldrive-net

  teldrive:
    image: ghcr.io/tgdrive/teldrive:latest
    container_name: teldrive-core
    restart: always
    depends_on:
      - db
    ports:
      - "8080:8080"
    # Sử dụng command để truyền biến môi trường (tránh lỗi trên Windows)
    command: >
      run
      --tg-app-id=YOUR_APP_ID
      --tg-app-hash=YOUR_APP_HASH
      --db-data-source="postgres://teldrive:teldrive_password@db:5432/teldrive?sslmode=disable"
      --jwt-secret="random_secret_string"
      --tg-uploads-encryption-key="chuoi_32_ky_tu_bat_ky_do_ban_chon"
    volumes:
      - ./teldrive_data:/root/.teldrive
    networks:
      - teldrive-net

networks:
  teldrive-net:
    driver: bridge</code></pre>
        </div>

        <div class="step-card">
            <h2><span class="step-number">3</span> Khởi chạy & Kết quả</h2>
            <p>Chạy lệnh sau trong Terminal:</p>
            <pre><code class="language-bash">docker-compose up -d</code></pre>
            <p>Sau đó truy cập <code>http://localhost:8080</code>. Đăng nhập và vào <strong>Settings -> Channels</strong> để chọn kênh lưu trữ mặc định.</p>
            
            <div class="row mt-3">
                <div class="col-md-6">
                    <p><strong>Giao diện Quản lý File:</strong></p>
                    <img src="anh1_teldrive.png" alt="Teldrive UI">
                </div>
                <div class="col-md-6">
                    <p><strong>Cấu hình Kênh lưu trữ:</strong></p>
                    <img src="anh2_teldrive.png" alt="Teldrive Settings">
                </div>
            </div>
        </div>

    </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>
</body>
</html>